

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Daily biomarker per dengue_interpretation (illness) &mdash; vital-oucru-clinical 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Understanding dengue prevalence" href="../../prevalence/index.html" />
    <link rel="prev" title="Daily biomarker per dengue_interpretation (admission)" href="plot_daily_boxplots_admission.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> vital-oucru-clinical
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets/overview.html">The OUCRU datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets/cleaning.html">The cleaning process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets/todo.html">Changelog</a></li>
</ul>
<p class="caption"><span class="caption-text">Galleries</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tables/index.html">Dataset description (tables)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Dataset description (graphs)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_daily_boxplots.html">Daily biomarker per dengue_interpretation (onset)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_daily_boxplots_admission.html">Daily biomarker per dengue_interpretation (admission)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Daily biomarker per dengue_interpretation (illness)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../prevalence/index.html">Understanding dengue prevalence</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">vital-oucru-clinical</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Dataset description (graphs)</a> &raquo;</li>
        
      <li>Daily biomarker per dengue_interpretation (illness)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/_examples/general/graphs/plot_daily_boxplots_illness.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-general-graphs-plot-daily-boxplots-illness-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="daily-biomarker-per-dengue-interpretation-illness">
<span id="sphx-glr-examples-general-graphs-plot-daily-boxplots-illness-py"></span><h1>Daily biomarker per dengue_interpretation (illness)<a class="headerlink" href="#daily-biomarker-per-dengue-interpretation-illness" title="Permalink to this headline">¶</a></h1>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Full explanation</p>
</div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Libraries</span>
 <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
 <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
 <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
 <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>

 <span class="c1"># DataBlend library</span>
 <span class="kn">from</span> <span class="nn">datablend.core.repair.correctors</span> <span class="kn">import</span> <span class="n">oucru_dengue_interpretation_feature</span>
 <span class="kn">from</span> <span class="nn">datablend.core.repair.correctors</span> <span class="kn">import</span> <span class="n">day_from_day_values</span>

 <span class="c1"># -----------------------------------</span>
 <span class="c1"># Configuration</span>
 <span class="c1"># -----------------------------------</span>
 <span class="c1"># Configure</span>
 <span class="c1">#sns.set_theme(style=&quot;ticks&quot;, palette=&quot;pastel&quot;)</span>

 <span class="c1"># Seaborn</span>
 <span class="c1">#sns.set_theme(style=&quot;whitegrid&quot;)</span>


 <span class="c1"># Update</span>
 <span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
     <span class="p">{</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
      <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span>
      <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span>
      <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="s1">&#39;large&#39;</span>
      <span class="p">})</span>

 <span class="c1"># -----------------------------------</span>
 <span class="c1"># Methods</span>
 <span class="c1"># -----------------------------------</span>

 <span class="c1"># -----------------------------------</span>
 <span class="c1"># Constants</span>
 <span class="c1"># -----------------------------------</span>
 <span class="c1"># Path with data</span>
 <span class="n">path_data</span> <span class="o">=</span> <span class="s1">&#39;../../../resources/data//20210313-v0.0.8/&#39;</span>
 <span class="n">path_data</span><span class="o">+=</span> <span class="s1">&#39;combined/combined_tidy.csv&#39;</span>


 <span class="n">rename</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;haematocrit_percent&#39;</span><span class="p">:</span> <span class="s1">&#39;hct&#39;</span><span class="p">,</span>
     <span class="s1">&#39;respiratory_rate&#39;</span><span class="p">:</span> <span class="s1">&#39;rr&#39;</span>
 <span class="p">}</span>

 <span class="n">NRR</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;plt&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mi">350</span><span class="p">],</span>
     <span class="s1">&#39;haematocrit_percent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span>
     <span class="s1">&#39;albumin&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
     <span class="s1">&#39;wbc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">]</span>
 <span class="p">}</span>

 <span class="n">FEATURES</span> <span class="o">=</span> <span class="p">[</span>
     <span class="s1">&#39;plt&#39;</span><span class="p">,</span>                   <span class="c1"># keep</span>
     <span class="s1">&#39;haematocrit_percent&#39;</span><span class="p">,</span>   <span class="c1"># keep</span>
     <span class="c1"># &#39;haemoglobin&#39;,         # too binary</span>
     <span class="s1">&#39;albumin&#39;</span><span class="p">,</span>               <span class="c1"># keep</span>
     <span class="s1">&#39;alt&#39;</span><span class="p">,</span>                   <span class="c1"># keep</span>
     <span class="s1">&#39;ast&#39;</span><span class="p">,</span>                   <span class="c1"># keep</span>
     <span class="s1">&#39;wbc&#39;</span><span class="p">,</span>                   <span class="c1"># keep</span>
     <span class="c1"># &#39;creatine_kinase&#39;,     # only beginning</span>
     <span class="c1"># &#39;lymphocytes&#39;,   # only beginning</span>
     <span class="c1"># &#39;monocytes&#39;,     # only beginning</span>
     <span class="c1"># &#39;neutrophils&#39;,   # only beginning</span>
     <span class="c1"># &#39;creatinine&#39;,    # so so</span>
     <span class="c1"># &#39;crp&#39;,           # not much data</span>
     <span class="c1"># &#39;procalcitonin&#39;, # not much data</span>
     <span class="c1"># &#39;sbp&#39;,           # too binary</span>
     <span class="c1"># &#39;dbp&#39;,           # too binary</span>
     <span class="c1"># &#39;pulse&#39;,</span>
     <span class="c1"># &#39;pulse_pressure&#39;,</span>
     <span class="c1"># &#39;respiratory_rate&#39;,</span>
     <span class="c1"># &#39;body_temperature&#39;,</span>
     <span class="c1"># &#39;spo2_percent&#39;,</span>
 <span class="p">]</span>

 <span class="c1"># The due to separate</span>
 <span class="n">HUE</span> <span class="o">=</span> <span class="s1">&#39;dengue_interpretation&#39;</span>

 <span class="c1"># The day column to use</span>
 <span class="c1">#   - day_from_onset</span>
 <span class="c1">#   - day_from_admission</span>
 <span class="c1">#   - day_from_enrolment</span>
 <span class="c1">#   - day_from_illness (manually inputed by clinicians)</span>
 <span class="n">DAY_COLUMN</span> <span class="o">=</span> <span class="s1">&#39;day_from_illness&#39;</span>

 <span class="c1"># ------------------------------</span>
 <span class="c1"># Load data</span>
 <span class="c1"># ------------------------------</span>
 <span class="c1"># Load data</span>
 <span class="n">original</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_data</span><span class="p">,</span>
     <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
     <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="c1">#nrows=1000000,</span>
     <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>

 <span class="c1"># Copy data</span>
 <span class="n">data</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
 <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">convert_dtypes</span><span class="p">()</span>

 <span class="c1"># Create dengue interpretation</span>
 <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dengue_interpretation&#39;</span><span class="p">]</span> <span class="o">=</span> \
     <span class="n">oucru_dengue_interpretation_feature</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
         <span class="n">pcr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ns1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">igm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">serology</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">single_igm_igg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">paired_igm_igg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

 <span class="c1"># Need to remove outliers earlier on!</span>
 <span class="n">idxs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plt</span> <span class="o">&gt;</span> <span class="mi">1000</span>
 <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="s1">&#39;plt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


 <span class="sd">&quot;&quot;&quot;</span>
<span class="sd"> # Correct day from illness</span>
<span class="sd"> # TOO SLOW!</span>
<span class="sd"> aux = \</span>
<span class="sd">     data.groupby(&#39;study_no&#39;) \</span>
<span class="sd">         .apply(day_from_day_values) \</span>
<span class="sd">         .droplevel(level=0, axis=0) \</span>
<span class="sd">         .dt.days</span>
<span class="sd"> &quot;&quot;&quot;</span>

 <span class="c1"># Create day for x-axis.</span>
 <span class="n">data</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">DAY_COLUMN</span><span class="p">]</span>
 <span class="n">data</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
 <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span>

 <span class="c1"># Drop columns with all NaN.</span>
 <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

 <span class="c1"># Show information</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dengue count:&quot;</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dengue_interpretation</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

 <span class="c1"># Rename this variables...</span>
 <span class="n">a</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="n">FEATURES</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;dengue_interpretation&#39;</span><span class="p">]]</span>
 <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;dengue_interpretation&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

 <span class="n">b</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="n">FEATURES</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;dsource&#39;</span><span class="p">]]</span>
 <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;dsource&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

 <span class="c1"># --------------------------------</span>
 <span class="c1"># Plot the biomarker distributions</span>
 <span class="c1"># --------------------------------</span>
 <span class="c1"># .. note:: Could this be done nicely without a loop by using</span>
 <span class="c1">#           some of the seaborn functionality such as the</span>
 <span class="c1">#           FaceGrid? Note we can also incorporate the hue.</span>

 <span class="c1"># Loop</span>
 <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">FEATURES</span><span class="p">):</span>

     <span class="c1"># Draw</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Drawing... </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">c</span><span class="p">)</span>

     <span class="c1"># Create figure</span>
     <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> \
         <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

     <span class="c1"># Configuration and plot</span>
     <span class="n">sns</span><span class="o">.</span><span class="n">set_color_codes</span><span class="p">(</span><span class="s2">&quot;muted&quot;</span><span class="p">)</span>
     <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">whis</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                 <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;dengue_interpretation&#39;</span><span class="p">,</span>
                 <span class="n">fliersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                 <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set3&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

     <span class="c1"># Draw normal reference range</span>
     <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">NRR</span><span class="p">:</span>
         <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
              <span class="n">y1</span><span class="o">=</span><span class="n">NRR</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">y2</span><span class="o">=</span><span class="n">NRR</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#D3D3D3&#39;</span><span class="p">,</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

     <span class="c1"># Create aux table for visualization</span>
     <span class="n">aux</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">})</span>

     <span class="c1"># Draw table</span>
     <span class="n">table</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">aux</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
                       <span class="n">rowLabels</span><span class="o">=</span><span class="n">aux</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                       <span class="n">colLabels</span><span class="o">=</span><span class="n">aux</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                       <span class="n">cellLoc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
     <span class="n">table</span><span class="o">.</span><span class="n">auto_set_font_size</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
     <span class="n">table</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
     <span class="n">table</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">)</span>

     <span class="c1"># Sns plot config</span>
     <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

     <span class="c1"># Configure axes</span>
     <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[],</span>
         <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&lt;</span><span class="si">{0}</span><span class="s1">&gt; distribution group by &lt;</span><span class="si">{1}</span><span class="s1">&gt; for &lt;</span><span class="si">{2}</span><span class="s1">&gt;&#39;</span> \
             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">HUE</span><span class="p">,</span> <span class="n">DAY_COLUMN</span><span class="p">))</span>
     <span class="c1">#axes[i].get_legend().remove()</span>

     <span class="c1"># Adjust subplots</span>
     <span class="c1">#plt.legend(loc=&#39;upper left&#39;)</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
     <span class="c1">#plt.tight_layout()</span>
</pre></div>
</td></tr></table></div>
<ul class="sphx-glr-horizontal">
<li><img alt="&lt;plt&gt; distribution group by &lt;dengue_interpretation&gt; for &lt;day_from_illness&gt;" class="sphx-glr-multi-img" src="../../../_images/sphx_glr_plot_daily_boxplots_illness_001.png" />
</li>
<li><img alt="&lt;haematocrit_percent&gt; distribution group by &lt;dengue_interpretation&gt; for &lt;day_from_illness&gt;" class="sphx-glr-multi-img" src="../../../_images/sphx_glr_plot_daily_boxplots_illness_002.png" />
</li>
<li><img alt="&lt;albumin&gt; distribution group by &lt;dengue_interpretation&gt; for &lt;day_from_illness&gt;" class="sphx-glr-multi-img" src="../../../_images/sphx_glr_plot_daily_boxplots_illness_003.png" />
</li>
<li><img alt="&lt;alt&gt; distribution group by &lt;dengue_interpretation&gt; for &lt;day_from_illness&gt;" class="sphx-glr-multi-img" src="../../../_images/sphx_glr_plot_daily_boxplots_illness_004.png" />
</li>
<li><img alt="&lt;ast&gt; distribution group by &lt;dengue_interpretation&gt; for &lt;day_from_illness&gt;" class="sphx-glr-multi-img" src="../../../_images/sphx_glr_plot_daily_boxplots_illness_005.png" />
</li>
<li><img alt="&lt;wbc&gt; distribution group by &lt;dengue_interpretation&gt; for &lt;day_from_illness&gt;" class="sphx-glr-multi-img" src="../../../_images/sphx_glr_plot_daily_boxplots_illness_006.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Applying... oucru_dengue_interpretation_feature.

Dengue count:
True     20569
False    15785
Name: dengue_interpretation, dtype: Int64
  Drawing... plt.
  Drawing... haematocrit_percent.
  Drawing... albumin.
  Drawing... alt.
  Drawing... ast.
  Drawing... wbc.
</pre></div>
</div>
<p>Lets plot the <code class="docutils literal notranslate"><span class="pre">overall</span></code> count of samples for each dataset and day. Note
that some datasets (13dx and md) have a much larger number of patients
and therefore the colors are “biased” towards them.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Configuration</span>
 <span class="n">n_cols</span> <span class="o">=</span> <span class="mi">2</span>
 <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">FEATURES</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">)</span>

 <span class="c1"># -----------------------</span>
 <span class="c1"># Plot heatmaps</span>
 <span class="c1"># ----------------------</span>
 <span class="c1"># Create figure</span>
 <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span>
     <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

 <span class="c1"># Flatten</span>
 <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

 <span class="c1"># Loop</span>
 <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">FEATURES</span><span class="p">):</span>

     <span class="c1"># Show</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">:&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

     <span class="c1"># Draw a heatmap with the numeric values in each cell</span>
     <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.0f&#39;</span><span class="p">,</span>
         <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="n">linewidths</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">rocket_r</span><span class="p">)</span>

     <span class="c1"># Configure axes</span>
     <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

 <span class="c1"># Adjust</span>
 <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<img alt="&lt;plt&gt;, &lt;haematocrit_percent&gt;, &lt;albumin&gt;, &lt;alt&gt;, &lt;ast&gt;, &lt;wbc&gt;" class="sphx-glr-single-img" src="../../../_images/sphx_glr_plot_daily_boxplots_illness_007.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>plt:
day       0      1      2       3       4       5       6       7      8      9      10    11    12    13    14    15    16    17    18    19    20
dsource
01nva    NaN    3.0   10.0    19.0    30.0    30.0    14.0     3.0    NaN    NaN    1.0   NaN   NaN   NaN   1.0   NaN   NaN   NaN   NaN   NaN   NaN
06dx     NaN    2.0  165.0   139.0   221.0   220.0   221.0   209.0  168.0   83.0   28.0   4.0   1.0   1.0   NaN   NaN   NaN   NaN   NaN   NaN   NaN
13dx     NaN    3.0   21.0    50.0    60.0    28.0     2.0     0.0    1.0    NaN    NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
d001     NaN    NaN   18.0    23.0     4.0     7.0    13.0     NaN    NaN    NaN    NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
df       NaN    NaN    0.0    59.0   247.0   328.0   111.0    15.0    1.0    0.0    1.0   0.0   0.0   0.0   0.0   NaN   NaN   0.0   NaN   NaN   NaN
dr       NaN  275.0  928.0   330.0   200.0   116.0   105.0    69.0   12.0    1.0    NaN   NaN   NaN   NaN   1.0   4.0  10.0  21.0  17.0  12.0   9.0
fl       NaN   14.0   84.0   207.0   364.0   549.0   646.0   619.0  529.0  332.0  189.0  75.0  37.0  20.0  15.0  15.0  10.0   8.0   3.0   2.0  14.0
md       1.0   54.0  430.0  1348.0  2387.0  2421.0  2340.0  2032.0  849.0  447.0   94.0  12.0   3.0   1.0   1.0   0.0   0.0   NaN   NaN   1.0   NaN


haematocrit_percent:
day       0      1      2       3       4       5       6       7       8      9      10    11    12    13    14    15    16    17    18    19    20
dsource
01nva    NaN    3.0   10.0    19.0    30.0    30.0    14.0     3.0     NaN    NaN    1.0   NaN   NaN   NaN   1.0   NaN   NaN   NaN   NaN   NaN   NaN
06dx     NaN    2.0  165.0   139.0   221.0   220.0   221.0   209.0   167.0   83.0   29.0   5.0   1.0   1.0   NaN   NaN   NaN   NaN   NaN   NaN   NaN
13dx     NaN    2.0   16.0    56.0    54.0    32.0     2.0     0.0     1.0    NaN    NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
d001     NaN    NaN   15.0    18.0     3.0     7.0    12.0     NaN     NaN    NaN    NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
df       NaN    NaN    0.0    60.0   247.0   326.0   113.0    15.0     1.0    0.0    1.0   0.0   0.0   0.0   0.0   NaN   NaN   0.0   NaN   NaN   NaN
dr       NaN  275.0  928.0   330.0   200.0   116.0   105.0    69.0    12.0    1.0    NaN   NaN   NaN   NaN   1.0   4.0  10.0  22.0  17.0  12.0   9.0
fl       NaN   14.0   84.0   207.0   362.0   547.0   650.0   620.0   528.0  332.0  190.0  76.0  37.0  21.0  15.0  16.0  11.0   9.0   2.0   2.0  13.0
md       1.0   68.0  596.0  1983.0  3119.0  2996.0  2664.0  2511.0  1122.0  547.0  112.0  20.0   3.0   1.0   1.0   0.0   0.0   NaN   NaN   2.0   NaN


albumin:
day       0    1      2     3      4      5      6      7      8     9     10   11   12   13   14   15   16   17   18   19   20
dsource
01nva    NaN  0.0    0.0   0.0    0.0    0.0    0.0    0.0    NaN   NaN   0.0  NaN  NaN  NaN  0.0  NaN  NaN  NaN  NaN  NaN  NaN
06dx     NaN  2.0  163.0  58.0    0.0    5.0  207.0    7.0    1.0   0.0   0.0  0.0  0.0  0.0  NaN  NaN  NaN  NaN  NaN  NaN  NaN
13dx     NaN  0.0    0.0   1.0    0.0    0.0    0.0    0.0    0.0   NaN   NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN
d001     NaN  NaN    0.0   0.0    2.0    3.0    8.0    NaN    NaN   NaN   NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN
df       NaN  NaN    0.0   0.0    0.0    0.0    0.0    0.0    0.0   0.0   0.0  0.0  0.0  0.0  0.0  NaN  NaN  0.0  NaN  NaN  NaN
dr       NaN  0.0    0.0   0.0    0.0    0.0    0.0    0.0    0.0   0.0   NaN  NaN  NaN  NaN  0.0  0.0  0.0  0.0  0.0  0.0  0.0
fl       NaN  2.0   19.0  87.0  144.0  244.0  258.0  217.0  227.0  75.0  30.0  5.0  7.0  7.0  3.0  3.0  2.0  2.0  1.0  0.0  8.0
md       0.0  0.0    0.0   0.0    0.0    0.0    0.0    0.0    0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  NaN  NaN  0.0  NaN


alt:
day       0    1      2      3      4      5      6      7      8     9     10   11   12   13   14   15   16   17   18   19    20
dsource
01nva    NaN  3.0    8.0   16.0   25.0   21.0   13.0    2.0    NaN   NaN   0.0  NaN  NaN  NaN  1.0  NaN  NaN  NaN  NaN  NaN   NaN
06dx     NaN  2.0  164.0   59.0    2.0    6.0  210.0   16.0    6.0   7.0   2.0  1.0  2.0  0.0  NaN  NaN  NaN  NaN  NaN  NaN   NaN
13dx     NaN  0.0    0.0    1.0    0.0    0.0    0.0    0.0    0.0   NaN   NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN
d001     NaN  NaN    4.0    3.0    2.0    3.0    7.0    NaN    NaN   NaN   NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN
df       NaN  NaN    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0   0.0  0.0  0.0  0.0  0.0  NaN  NaN  0.0  NaN  NaN   NaN
dr       NaN  0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0   NaN  NaN  NaN  NaN  0.0  0.0  0.0  0.0  0.0  0.0   0.0
fl       NaN  3.0   26.0  100.0  162.0  273.0  268.0  218.0  238.0  81.0  35.0  6.0  9.0  9.0  3.0  5.0  3.0  3.0  2.0  1.0  10.0
md       0.0  0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  NaN  NaN  0.0   NaN


ast:
day       0    1      2      3      4      5      6      7      8     9     10   11   12   13   14   15   16   17   18   19    20
dsource
01nva    NaN  3.0    8.0   16.0   25.0   21.0   13.0    2.0    NaN   NaN   0.0  NaN  NaN  NaN  1.0  NaN  NaN  NaN  NaN  NaN   NaN
06dx     NaN  2.0  164.0   59.0    2.0    6.0  210.0   16.0    6.0   7.0   2.0  1.0  2.0  0.0  NaN  NaN  NaN  NaN  NaN  NaN   NaN
13dx     NaN  0.0    0.0    1.0    0.0    0.0    0.0    0.0    0.0   NaN   NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN
d001     NaN  NaN    4.0    3.0    2.0    3.0    7.0    NaN    NaN   NaN   NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN
df       NaN  NaN    0.0   20.0  115.0  197.0   76.0   10.0    0.0   0.0   0.0  0.0  0.0  0.0  0.0  NaN  NaN  0.0  NaN  NaN   NaN
dr       NaN  0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0   NaN  NaN  NaN  NaN  0.0  0.0  0.0  0.0  0.0  0.0   0.0
fl       NaN  3.0   26.0  100.0  162.0  272.0  267.0  218.0  239.0  81.0  35.0  6.0  9.0  9.0  3.0  5.0  3.0  3.0  2.0  1.0  10.0
md       0.0  0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0   0.0  0.0  0.0  0.0  0.0  0.0  0.0  NaN  NaN  0.0   NaN


wbc:
day       0      1      2      3      4      5      6      7      8      9      10    11    12    13    14    15   16    17    18    19    20
dsource
01nva    NaN    3.0   10.0   19.0   30.0   30.0   14.0    3.0    NaN    NaN    1.0   NaN   NaN   NaN   1.0   NaN  NaN   NaN   NaN   NaN   NaN
06dx     NaN    2.0  165.0  139.0  221.0  220.0  221.0  209.0  166.0   83.0   28.0   4.0   1.0   1.0   NaN   NaN  NaN   NaN   NaN   NaN   NaN
13dx     NaN    0.0    0.0    1.0    0.0    0.0    0.0    0.0    0.0    NaN    NaN   NaN   NaN   NaN   NaN   NaN  NaN   NaN   NaN   NaN   NaN
d001     NaN    NaN   15.0   18.0    3.0    7.0   12.0    NaN    NaN    NaN    NaN   NaN   NaN   NaN   NaN   NaN  NaN   NaN   NaN   NaN   NaN
df       NaN    NaN    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0   0.0   0.0   0.0   NaN  NaN   0.0   NaN   NaN   NaN
dr       NaN  246.0  832.0  302.0  184.0   98.0   88.0   59.0    9.0    0.0    NaN   NaN   NaN   NaN   1.0   3.0  8.0  16.0  14.0  11.0   8.0
fl       NaN   13.0   78.0  201.0  342.0  530.0  633.0  605.0  521.0  315.0  169.0  66.0  28.0  19.0  13.0  14.0  8.0   9.0   2.0   2.0  13.0
md       0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0   0.0   0.0   0.0   0.0  0.0   NaN   NaN   0.0   NaN
</pre></div>
</div>
<p>Lets plot the <code class="docutils literal notranslate"><span class="pre">normalized</span></code> count of samples for each individual dataset
and the corresponding day</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># -----------------------</span>
 <span class="c1"># Plot heatmaps</span>
 <span class="c1"># ----------------------</span>
 <span class="c1"># Create figure</span>
 <span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span>
     <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

 <span class="c1"># Flatten</span>
 <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

 <span class="c1"># Loop</span>
 <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">FEATURES</span><span class="p">):</span>

     <span class="c1"># Compute normalised</span>
     <span class="n">norm</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">T</span>

     <span class="c1"># Print</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">:&quot;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>

     <span class="c1"># Draw a heatmap with the numeric values in each cell</span>
     <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">norm</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.0f&#39;</span><span class="p">,</span>
         <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="n">linewidths</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">rocket_r</span><span class="p">)</span>

     <span class="c1"># Configure axes</span>
     <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&lt;</span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>

 <span class="c1"># Adjust</span>
 <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

 <span class="c1"># Plot</span>
 <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

 <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</td></tr></table></div>
<img alt="&lt;plt&gt;, &lt;haematocrit_percent&gt;, &lt;albumin&gt;, &lt;alt&gt;, &lt;ast&gt;, &lt;wbc&gt;" class="sphx-glr-single-img" src="../../../_images/sphx_glr_plot_daily_boxplots_illness_008.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>plt:
day            0         1         2         3         4         5         6         7         8         9   ...        11        12        13        14       15        16        17        18        19        20
dsource                                                                                                      ...
01nva         NaN  0.100000  0.333333  0.633333  1.000000  1.000000  0.466667  0.100000       NaN       NaN  ...       NaN       NaN       NaN  0.033333      NaN       NaN       NaN       NaN       NaN       NaN
06dx          NaN  0.009050  0.746606  0.628959  1.000000  0.995475  1.000000  0.945701  0.760181  0.375566  ...  0.018100  0.004525  0.004525       NaN      NaN       NaN       NaN       NaN       NaN       NaN
13dx          NaN  0.050000  0.350000  0.833333  1.000000  0.466667  0.033333  0.000000  0.016667       NaN  ...       NaN       NaN       NaN       NaN      NaN       NaN       NaN       NaN       NaN       NaN
d001          NaN       NaN  0.782609  1.000000  0.173913  0.304348  0.565217       NaN       NaN       NaN  ...       NaN       NaN       NaN       NaN      NaN       NaN       NaN       NaN       NaN       NaN
df            NaN       NaN  0.000000  0.179878  0.753049  1.000000  0.338415  0.045732  0.003049  0.000000  ...  0.000000  0.000000  0.000000  0.000000      NaN       NaN  0.000000       NaN       NaN       NaN
dr            NaN  0.296336  1.000000  0.355603  0.215517  0.125000  0.113147  0.074353  0.012931  0.001078  ...       NaN       NaN       NaN  0.001078  0.00431  0.010776  0.022629  0.018319  0.012931  0.009698
fl            NaN  0.021672  0.130031  0.320433  0.563467  0.849845  1.000000  0.958204  0.818885  0.513932  ...  0.116099  0.057276  0.030960  0.023220  0.02322  0.015480  0.012384  0.004644  0.003096  0.021672
md       0.000413  0.022305  0.177613  0.556795  0.985956  1.000000  0.966543  0.839323  0.350682  0.184634  ...  0.004957  0.001239  0.000413  0.000413  0.00000  0.000000       NaN       NaN  0.000413       NaN

[8 rows x 21 columns]


haematocrit_percent:
day            0         1         2         3         4         5         6         7         8         9   ...        11        12        13        14        15        16        17        18        19        20
dsource                                                                                                      ...
01nva         NaN  0.100000  0.333333  0.633333  1.000000  1.000000  0.466667  0.100000       NaN       NaN  ...       NaN       NaN       NaN  0.033333       NaN       NaN       NaN       NaN       NaN       NaN
06dx          NaN  0.009050  0.746606  0.628959  1.000000  0.995475  1.000000  0.945701  0.755656  0.375566  ...  0.022624  0.004525  0.004525       NaN       NaN       NaN       NaN       NaN       NaN       NaN
13dx          NaN  0.035714  0.285714  1.000000  0.964286  0.571429  0.035714  0.000000  0.017857       NaN  ...       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
d001          NaN       NaN  0.833333  1.000000  0.166667  0.388889  0.666667       NaN       NaN       NaN  ...       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
df            NaN       NaN  0.000000  0.184049  0.757669  1.000000  0.346626  0.046012  0.003067  0.000000  ...  0.000000  0.000000  0.000000  0.000000       NaN       NaN  0.000000       NaN       NaN       NaN
dr            NaN  0.296336  1.000000  0.355603  0.215517  0.125000  0.113147  0.074353  0.012931  0.001078  ...       NaN       NaN       NaN  0.001078  0.004310  0.010776  0.023707  0.018319  0.012931  0.009698
fl            NaN  0.021538  0.129231  0.318462  0.556923  0.841538  1.000000  0.953846  0.812308  0.510769  ...  0.116923  0.056923  0.032308  0.023077  0.024615  0.016923  0.013846  0.003077  0.003077  0.020000
md       0.000321  0.021802  0.191087  0.635781  1.000000  0.960564  0.854120  0.805066  0.359731  0.175377  ...  0.006412  0.000962  0.000321  0.000321  0.000000  0.000000       NaN       NaN  0.000641       NaN

[8 rows x 21 columns]


albumin:
day      0         1         2         3        4         5    6         7         8         9         10       11        12        13        14        15        16        17        18   19        20
dsource
01nva   NaN       NaN       NaN       NaN      NaN       NaN  NaN       NaN       NaN       NaN       NaN      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN  NaN       NaN
06dx    NaN  0.009662  0.787440  0.280193  0.00000  0.024155  1.0  0.033816  0.004831  0.000000  0.000000  0.00000  0.000000  0.000000       NaN       NaN       NaN       NaN       NaN  NaN       NaN
13dx    NaN  0.000000  0.000000  1.000000  0.00000  0.000000  0.0  0.000000  0.000000       NaN       NaN      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN  NaN       NaN
d001    NaN       NaN  0.000000  0.000000  0.25000  0.375000  1.0       NaN       NaN       NaN       NaN      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN  NaN       NaN
df      NaN       NaN       NaN       NaN      NaN       NaN  NaN       NaN       NaN       NaN       NaN      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN  NaN       NaN
dr      NaN       NaN       NaN       NaN      NaN       NaN  NaN       NaN       NaN       NaN       NaN      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN  NaN       NaN
fl      NaN  0.007752  0.073643  0.337209  0.55814  0.945736  1.0  0.841085  0.879845  0.290698  0.116279  0.01938  0.027132  0.027132  0.011628  0.011628  0.007752  0.007752  0.003876  0.0  0.031008
md      NaN       NaN       NaN       NaN      NaN       NaN  NaN       NaN       NaN       NaN       NaN      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN  NaN       NaN


alt:
day      0         1         2         3         4         5         6         7         8         9         10        11        12        13        14        15        16        17        18        19       20
dsource
01nva   NaN  0.120000  0.320000  0.640000  1.000000  0.840000  0.520000  0.080000       NaN       NaN  0.000000       NaN       NaN       NaN  0.040000       NaN       NaN       NaN       NaN       NaN      NaN
06dx    NaN  0.009524  0.780952  0.280952  0.009524  0.028571  1.000000  0.076190  0.028571  0.033333  0.009524  0.004762  0.009524  0.000000       NaN       NaN       NaN       NaN       NaN       NaN      NaN
13dx    NaN  0.000000  0.000000  1.000000  0.000000  0.000000  0.000000  0.000000  0.000000       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN      NaN
d001    NaN       NaN  0.571429  0.428571  0.285714  0.428571  1.000000       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN      NaN
df      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN      NaN
dr      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN      NaN
fl      NaN  0.010989  0.095238  0.366300  0.593407  1.000000  0.981685  0.798535  0.871795  0.296703  0.128205  0.021978  0.032967  0.032967  0.010989  0.018315  0.010989  0.010989  0.007326  0.003663  0.03663
md      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN      NaN


ast:
day      0         1         2         3         4         5         6         7         8         9         10        11        12        13        14        15        16        17        18        19        20
dsource
01nva   NaN  0.120000  0.320000  0.640000  1.000000  0.840000  0.520000  0.080000       NaN       NaN  0.000000       NaN       NaN       NaN  0.040000       NaN       NaN       NaN       NaN       NaN       NaN
06dx    NaN  0.009524  0.780952  0.280952  0.009524  0.028571  1.000000  0.076190  0.028571  0.033333  0.009524  0.004762  0.009524  0.000000       NaN       NaN       NaN       NaN       NaN       NaN       NaN
13dx    NaN  0.000000  0.000000  1.000000  0.000000  0.000000  0.000000  0.000000  0.000000       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
d001    NaN       NaN  0.571429  0.428571  0.285714  0.428571  1.000000       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
df      NaN       NaN  0.000000  0.101523  0.583756  1.000000  0.385787  0.050761  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000       NaN       NaN  0.000000       NaN       NaN       NaN
dr      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
fl      NaN  0.011029  0.095588  0.367647  0.595588  1.000000  0.981618  0.801471  0.878676  0.297794  0.128676  0.022059  0.033088  0.033088  0.011029  0.018382  0.011029  0.011029  0.007353  0.003676  0.036765
md      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN


wbc:
day      0         1         2         3         4         5         6         7         8         9         10        11        12        13        14        15        16        17        18        19        20
dsource
01nva   NaN  0.100000  0.333333  0.633333  1.000000  1.000000  0.466667  0.100000       NaN       NaN  0.033333       NaN       NaN       NaN  0.033333       NaN       NaN       NaN       NaN       NaN       NaN
06dx    NaN  0.009050  0.746606  0.628959  1.000000  0.995475  1.000000  0.945701  0.751131  0.375566  0.126697  0.018100  0.004525  0.004525       NaN       NaN       NaN       NaN       NaN       NaN       NaN
13dx    NaN  0.000000  0.000000  1.000000  0.000000  0.000000  0.000000  0.000000  0.000000       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
d001    NaN       NaN  0.833333  1.000000  0.166667  0.388889  0.666667       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
df      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
dr      NaN  0.295673  1.000000  0.362981  0.221154  0.117788  0.105769  0.070913  0.010817  0.000000       NaN       NaN       NaN       NaN  0.001202  0.003606  0.009615  0.019231  0.016827  0.013221  0.009615
fl      NaN  0.020537  0.123223  0.317536  0.540284  0.837283  1.000000  0.955766  0.823065  0.497630  0.266983  0.104265  0.044234  0.030016  0.020537  0.022117  0.012638  0.014218  0.003160  0.003160  0.020537
md      NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  24.692 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-general-graphs-plot-daily-boxplots-illness-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/a6fb0435178cfd34d4a8e3367ee889dd/plot_daily_boxplots_illness.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_daily_boxplots_illness.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/2ed9c6dbe0d9a88a6549eef03376f7d8/plot_daily_boxplots_illness.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_daily_boxplots_illness.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../../prevalence/index.html" class="btn btn-neutral float-right" title="Understanding dengue prevalence" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="plot_daily_boxplots_admission.html" class="btn btn-neutral float-left" title="Daily biomarker per dengue_interpretation (admission)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Imperial College London.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>